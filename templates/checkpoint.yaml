# Checkpoint & Backup System
# LMAgent Framework v3.0 - Ultra-Robust State Persistence
#
# Este archivo define el sistema de checkpoints automÃ¡ticos y backups
# para garantizar que NUNCA se pierda el estado del proyecto.
#
# UBICACIÃ“N: .lmagent/checkpoints/ (directorio)

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                    SISTEMA DE CHECKPOINTS AUTOMÃTICOS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# El agente debe crear un checkpoint en estos momentos:
#
# 1. FASE COMPLETADA
#    - DespuÃ©s de aprobar spec.yaml â†’ checkpoint "phase_specify_complete"
#    - DespuÃ©s de aprobar plan.yaml â†’ checkpoint "phase_plan_complete"
#    - DespuÃ©s de crear tasks.yaml â†’ checkpoint "phase_tasks_complete"
#    - DespuÃ©s de verificar â†’ checkpoint "phase_verify_complete"
#
# 2. TASK COMPLETADA
#    - DespuÃ©s de completar cada task â†’ checkpoint "task_T00X_complete"
#
# 3. DECISIÃ“N IMPORTANTE
#    - DespuÃ©s de decisiones arquitectÃ³nicas â†’ checkpoint "decision_DXXX"
#
# 4. SESIÃ“N FINALIZADA
#    - Cuando el usuario cierra la sesiÃ³n â†’ checkpoint "session_X_end"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                          ESTRUCTURA DE CHECKPOINT
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

checkpoint:
  id: "chk_20260123_143052"  # Formato: chk_YYYYMMDD_HHMMSS
  created_at: "2026-01-23T14:30:52"
  trigger: "task_complete"  # phase_complete | task_complete | decision | session_end | manual
  
  # QuÃ© disparÃ³ este checkpoint
  trigger_details:
    type: "task"
    id: "T002"
    title: "Crear endpoint GET /users"
  
  # Snapshot del estado completo
  state_snapshot:
    current_phase: "implement"
    spec_status: "approved"
    plan_status: "approved"
    tasks_total: 15
    tasks_completed: 2
    tasks_in_progress: 1
    tasks_pending: 12
    current_task_id: "T003"
  
  # Archivos que cambiaron desde el Ãºltimo checkpoint
  changed_files:
    - path: "src/models/user.py"
      action: "created"
    - path: "src/api/users.py"
      action: "modified"
    - path: "tests/test_users.py"
      action: "created"
  
  # Resumen en lenguaje natural (para que cualquier LLM entienda rÃ¡pido)
  summary: |
    Fase: ImplementaciÃ³n
    CompletÃ©: T002 - Endpoint GET /users
    CreÃ©: user.py, users.py, test_users.py
    PrÃ³ximo: T003 - Endpoint POST /users
    Tests passing: 5/5

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                       INSTRUCCIONES PARA EL AGENTE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# ğŸ¤– CREAR CHECKPOINT:
#
# DespuÃ©s de cada milestone significativo, ejecuta:
#
# ```python
# checkpoint = {
#     "id": f"chk_{datetime.now().strftime('%Y%m%d_%H%M%S')}",
#     "created_at": datetime.now().isoformat(),
#     "trigger": "task_complete",  # o el trigger correspondiente
#     "trigger_details": {...},
#     "state_snapshot": {...},
#     "changed_files": [...],
#     "summary": "..."
# }
# 
# # Guardar en .lmagent/checkpoints/chk_YYYYMMDD_HHMMSS.yaml
# ```
#
# ğŸ¤– RECUPERAR DE CHECKPOINT:
#
# Si el usuario dice "algo saliÃ³ mal" o "volver atrÃ¡s":
#
# 1. Listar checkpoints: ls .lmagent/checkpoints/
# 2. Mostrar Ãºltimos 5 al usuario
# 3. El usuario elige uno
# 4. Leer ese checkpoint y restaurar el estado
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                          POLÃTICA DE RETENCIÃ“N
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# Mantener:
# - Ãšltimos 20 checkpoints de tasks
# - Todos los checkpoints de fases (nunca borrar)
# - Ãšltimos 10 checkpoints de sesiÃ³n
#
# Limpiar automÃ¡ticamente cuando hay mÃ¡s de 50 checkpoints totales.
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
